<script>
  $(document).ready(function() { setupTablesorter() });
</script>
<h1>Listing Files</h1>
<%= render "partials/filter" %>

<% unless params[:pedigree].nil? or params[:pedigree][:id].blank? %>
  <p><b>Files for Pedigree <u><%= Pedigree.find(params[:pedigree][:id]).name %></u></b></p>
<% end %>
<% if @assay_files.size == 0 %>
  <p>No files fulfill these conditions.</p>
<% else %>
<table class="tablesorter">
  <thead>
  <tr>
    <th>Sample ID</th>
    <th>Pedigree</th>
    <th>Genome reference&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
    <th>Name</th>
    <th>Description&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
    <th>File type</th>
    <th>Software&nbsp;&nbsp;</th>
    <th>Software version</th>
    <th class="nosort">Controls</th>
  </tr>
  </thead>
  <tbody>
<% @assay_files.each do |assay_file| %>
  <% if assay_file.assay.nil? then %>
  <tr>
    <td></td>
    <td></td>
    <td><%= assay_file.genome_reference.name %></td>
    <td><nobr><%= assay_file.name %><nobr></td>
    <td><%= assay_file.description %></td>
    <td><%= assay_file.file_type %></td>
    <td><%= assay_file.software %></td>
    <td><%= assay_file.software_version %></td>
    <td><%= link_to 'Show', assay_file %></td>

  <% else %>
  <tr>
    <td><nobr><%= assay_file.assay.sample.nil? ? '' : assay_file.assay.sample.vendor_id %></nobr></td>
    <td><%= assay_file.assay.sample.nil? ? '' : assay_file.assay.sample.person.nil? ? '' : assay_file.assay.sample.person.pedigree.name %></td>
    <td><%= assay_file.genome_reference.name %></td>
    <td><nobr><%= assay_file.name %><nobr></td>
    <td><%= assay_file.description %></td>
    <td><%= assay_file.file_type %></td>
    <td><%= assay_file.software %></td>
    <td><%= assay_file.software_version %></td>
    <td><%= link_to 'Show', assay_file %></td>
  </tr>
  <% end %>
<% end %>
  </tbody>
</table>
<% end %>
<br />

<%= link_to 'New Assay file', new_assay_file_path %>
